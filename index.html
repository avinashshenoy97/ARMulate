<html>

<head>
	<link rel="stylesheet" type="text/css" href="style/index.css">
	<script src="scripts/memcontents.js"></script>
	<script>
		function setupMemory() {
			mem = new Object()
			mem.size = 16000;		//16 KB default
		}

		function setSize(n) {
			window.mem.size = n;
		}

		function refreshpage() {
			if(document.getElementById("encode"))
				document.getElementById("encode").remove();
			var d = document.getElementById("compile");
			d.style.display = "inline";
			d = d.nextElementSibling;
			d.style.display = "";

			var d = document.getElementById("run");
			d.style.display = "inline";
			d = d.nextElementSibling;
			d.style.display = "";

			var cont = document.getElementById("code");

			if(cont.tagName == "DIV")
				cont = cont.innerHTML;
			else
				cont = cont.value;

			cont = cont.replace(/<br>/g, "\n");
			cont = cont.replace(/<br\\>/g, "\n");
			cont = cont.replace(/<span class=("|')error("|')>/g, "");
			cont = cont.replace("</span>", "");

			document.getElementById("code").remove();
			var e = document.getElementById("editor");
			e.appendChild(document.createElement("textarea"));
			e = e.children[0];
			e.id = "code";
			e.style.width = (parseInt(document.getElementById("editor").style.width) - (8)) + "px";
			e.value = cont;

			var tab = document.getElementById("data");
			tab.appendChild(document.createElement("tbody"));
			tab.children[0].remove();

			window.datasec = new Object();
			window.cont = [];
			window.labs = new Object();

			setupMemory();
			instateMemory();
		}

		function goto() {
			var l = document.getElementById("gotoline").value;
			l = Math.floor(l / mem.width) * (mem.width);
			if(l != 0)
				l -= mem.width;
			document.getElementById("b" + l).scrollIntoView();
		}
	</script>
</head>

<body onresize="location.reload()">
	<div id="header">
		<img id = "dec" src="resources/dec.png" class="enab" style="display: none;">
		<img class = "dis" src="resources/dec.png" style="display: inline;">
		<img id = "bin" src="resources/bin.svg" class="enab">
		<img class = "dis" src="resources/bin.svg">
		<img id = "hex" src="resources/hex.png" class="enab">
		<img class = "dis" src="resources/hex.png">
		<img id = "interpret "src="resources/interpret.svg" class="enab">
		<img class = "dis" src="resources/interpret.svg">
		<img id = "compile" onclick = "processcont('0')" src="resources/compile.svg" class="enab">
		<img class = "dis" src="resources/compile.svg">
		<img id = "run" onclick = "" src="resources/run.svg" class="enab">
		<img class = "dis" src="resources/run.svg">
		<img id = "refresh" onclick = "refreshpage()" src="resources/reload.svg" class="enab">
		<span id="goto">
			<p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></p>
			<input type="text" id="gotoline">
			<button onclick="goto()">Go To</button>
		</span>
	</div>
	<div class="container" id="content">
		<div id="rbank">
			<table id="Rs">
				<tbody></tbody>
			</table>
			<table id="cpsr">
				<tbody>
				<tr class="r1">
					<td>N</td>
					<td>C</td>
					<td>Z</td>
					<td>V</td>
				</tr>
				<tr class="r2">
					<td id="nflag"></td>
					<td id="cflag"></td>
					<td id="zflag"></td>
					<td id="vflag"></td>
				</tr>
				</tbody>
			</table>
		</div>
		<div id="editor">
			<textarea id="code"></textarea>
		</div>
	</div>

	<div id="memory">
		<table id="data">
			<tbody>
			</tbody>
		</table>
	</div>

	<script src="scripts/index.js"></script>
	<script src="scripts/regcontents.js"></script>
	<script src = "scripts/comprun.js"></script>
	<script src = "scripts/interpreter.js"></script>
	<script>
		setupMemory();
		instateMemory();
	</script>
</body>

</html>